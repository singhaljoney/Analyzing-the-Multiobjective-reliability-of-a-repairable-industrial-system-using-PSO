x1=[0.000498481	0.000454929	0.000162946	0.00050995	0.000206976	0.000682788	0.000538104;
0.000332319	0.000335471	0.000155454	0.00044665	0.000315424	0.000708412	0.000714696;
0.000536478	0.000443796	0.000126796	0.000533803	0.000305905	0.000702814	0.000604393;
0.000294322	0.000346604	0.000191604	0.000422797	0.000216495	0.000688386	0.000648407;
0.000397595	0.000359512	0.000192223	0.000405824	0.000282254	0.000709863	0.000647372;
0.000433205	0.000430888	0.000126177	0.000550776	0.000240146	0.000681337	0.000605428;
0.000543065	0.000382411	0.000165506	0.000433317	0.000250794	0.000707927	0.00063709;
0.000287735	0.000407989	0.000152894	0.000523283	0.000271606	0.000683273	0.00061571;
0.000391697	0.000406931	0.000160198	0.000404286	0.000227035	0.000683595	0.000692197;
0.000439103	0.000383469	0.000158202	0.000552314	0.000295365	0.000707605	0.000560603;
0.000403395	0.000441712	0.000162348	0.000452736	0.000315622	0.00069484	0.000578317;
0.000427405	0.000348688	0.000156052	0.000503864	0.000206778	0.00069636	0.000674483;
0.000362963	0.000450495	0.000195544	0.000421109	0.000261241	0.000712875	0.000714117;
0.000467837	0.000339905	0.000122856	0.000535491	0.000261159	0.000678325	0.000538683;
0.000365388	0.000446557	0.000143976	0.000415637	0.00024228	0.000704222	0.000578167;
0.000465412	0.000343843	0.000174424	0.000540963	0.00028012	0.000686978	0.000674633;
0.000288443	0.000368665	0.000158691	0.000539931	0.000230076	0.000697311	0.000551907;
0.000542357	0.000421735	0.000159709	0.000416669	0.000292324	0.000693889	0.000700893;
0.000440549	0.00043187	0.000121361	0.00044713	0.000221868	0.000708314	0.000711035;
0.000390251	0.00035853	0.000197039	0.00050947	0.000300532	0.000682886	0.000541765;
0.00027363	0.000398918	0.000176214	0.000512882	0.000214818	0.000678283	0.000579002;
0.00055717	0.000391482	0.000142186	0.000443718	0.000307582	0.000712917	0.000673798;
0.000452713	0.000411081	0.000158856	0.000454816	0.000202909	0.000684134	0.000670627;
0.000378087	0.000379319	0.000159544	0.000501784	0.000319491	0.000707066	0.000582173;
0.000454896	0.000393956	0.000158515	0.000542037	0.000217938	0.000678506	0.000650899;
0.000375904	0.000396444	0.000159885	0.000414563	0.000304462	0.000712694	0.000601901;
0.000288472	0.00035654	0.000170955	0.000412241	0.000225186	0.000696994	0.000646053;
0.000542328	0.00043386	0.000147445	0.000544359	0.000297214	0.000694206	0.000606747;
0.000363749	0.000409337	0.000140987	0.000460938	0.00030452	0.000684861	0.000584087;
0.000467051	0.000381063	0.000177413	0.000495662	0.00021788	0.000706339	0.000668713;
0.000339527	0.000357076	0.000166181	0.00046689	0.000242503	0.000683954	0.000547523;
0.000491273	0.000433324	0.000152219	0.00048971	0.000279897	0.000707246	0.000705277;
0.000365243	0.000391339	0.000135612	0.000440048	0.000282337	0.000698354	0.000656635;
0.000465557	0.000399061	0.000182788	0.000516552	0.000240063	0.000692846	0.000596165;
0.000378552	0.000361075	0.000175922	0.000486918	0.0003151	0.000695037	0.000675206;
0.000452248	0.000429325	0.000142478	0.000469682	0.0002073	0.000696163	0.000577594;
0.000313248	0.000384167	0.000193417	0.000504566	0.000302487	0.00068136	0.000711936;
0.000517552	0.000406233	0.000124983	0.000452034	0.000219913	0.00070984	0.000540864;
0.000355474	0.000336461	0.000131756	0.000436734	0.000224646	0.000682088	0.00063516;
0.000475326	0.000453939	0.000186644	0.000519866	0.000297754	0.000709112	0.00061764;
0.000259991	0.000386516	0.000124593	0.000466193	0.000283831	0.000700854	0.000548964;
0.000570809	0.000403884	0.000193807	0.000490407	0.000238569	0.000690346	0.000703836;
0.000401999	0.000379677	0.000144827	0.000519056	0.000218064	0.000705587	0.000689688;
0.000428801	0.000410723	0.000173573	0.000437544	0.000304336	0.000685613	0.000563112;
0.00026976	0.000410409	0.000184532	0.000432697	0.000250618	0.000685471	0.000544992;
0.00056104	0.000379991	0.000133868	0.000523903	0.000271782	0.000705729	0.000707808;
0.000352671	0.00036765	0.000159076	0.000443795	0.000282107	0.000686761	0.000705327;
0.000478129	0.00042275	0.000159324	0.000512805	0.000240293	0.000704439	0.000547473;
0.000359946	0.000367208	0.000197067	0.00045224	0.000311984	0.000694783	0.000636501;
0.000470854	0.000423192	0.000121333	0.00050436	0.000210416	0.000696417	0.000616299;
0.000520511	0.000417199	0.000191727	0.00048253	0.000244579	0.000687742	0.000703469;
0.000310289	0.000373201	0.000126673	0.00047407	0.000277821	0.000703458	0.000549331;
0.000479817	0.000333832	0.000170784	0.000471267	0.0002501	0.000706383	0.000615075;
0.000350983	0.000456568	0.000147616	0.000485333	0.0002723	0.000684817	0.000637725;
0.000538855	0.000384768	0.00013286	0.000455301	0.00022678	0.000697215	0.000546839;
0.000291945	0.000405632	0.00018554	0.000501299	0.00029562	0.000693985	0.000705961;
0.000278956	0.000452803	0.000183537	0.00051599	0.000275863	0.000706689	0.000593094;
0.000551844	0.000337597	0.000134863	0.00044061	0.000246537	0.000684511	0.000659706;
0.000550496	0.00041331	0.000165453	0.000492374	0.000205313	0.000679388	0.000579124;
0.000280304	0.00037709	0.000152947	0.000464226	0.000317087	0.000711812	0.000673676;
0.000482999	0.000400383	0.000159704	0.000415704	0.00020663	0.000690754	0.000585333;
0.000347801	0.000390017	0.000158696	0.000540896	0.00031577	0.000700446	0.000667467;
0.000284146	0.000388008	0.000169905	0.000394324	0.00021255	0.000688337	0.000568703
0.000546654	0.000402392	0.000148495	0.000562276	0.00030985	0.000702863	0.000684097;
0.000542454	0.000398899	0.000126613	0.000500318	0.000275773	0.000682362	0.000613629;
0.000288346	0.000391501	0.000191787	0.000456282	0.000246627	0.000708838	0.000639171;
0.000299521	0.000431489	0.000162192	0.00041827	0.000287692	0.000681102	0.000596822;
0.000531279	0.000358911	0.000156208	0.00053833	0.000234708	0.000710098	0.000655978;
0.00041199	0.000366313	0.000130974	0.000560532	0.000239034	0.000679515	0.000645274;
0.00041881	0.000424087	0.000187426	0.000396068	0.000283366	0.000711685	0.000607526;
0.000305119	0.000423793	0.000129646	0.00048268	0.000292601	0.000693677	0.0006942;
0.000525681	0.000366607	0.000188754	0.00047392	0.000229799	0.000697523	0.0005586;
0.000490226	0.000416644	0.000173879	0.000532812	0.000223228	0.000711573	0.000678411;
0.000340574	0.000373756	0.000144521	0.000423788	0.000299172	0.000679627	0.000574389;
0.000419411	0.000430413	0.000173782	0.000449463	0.000237349	0.000713396	0.000678828;
0.000411389	0.000359987	0.000144618	0.000507137	0.000285051	0.000677804	0.000573972;
0.0002662	0.000418019	0.000180958	0.000535868	0.000218154	0.000688256	0.000649825;
0.0005646	0.000372381	0.000137442	0.000420732	0.000304246	0.000702944	0.000602975;
0.000279596	0.000394824	0.00015999	0.000505547	0.000286299	0.000686997	0.000644996;
0.000551204	0.000395576	0.00015841	0.000451053	0.000236101	0.000704203	0.000607804;
0.000510287	0.000336952	0.000138313	0.000507096	0.000242168	0.000714024	0.000660657;
0.000320513	0.000453448	0.000180087	0.000449504	0.000280232	0.000677176	0.000592143;
0.000279199	0.000360127	0.000163389	0.000412235	0.000264189	0.000709982	0.000639444;
0.000551601	0.000430273	0.000155011	0.000544365	0.000258211	0.000681218	0.000613356;
0.000337616	0.000436859	0.000182878	0.000448477	0.000204914	0.000685992	0.00064844;
0.000493184	0.000353541	0.000135522	0.000508123	0.000317486	0.000705208	0.00060436;
0.000474443	0.000442418	0.000150884	0.000534965	0.000309393	0.000712139	0.000703864;
0.000356357	0.000347982	0.000167516	0.000421635	0.000213007	0.000679061	0.000548936;
0.000338916	0.000337042	0.00016997	0.000515613	0.000318411	0.000710939	0.000548013;
0.000491884	0.000453358	0.00014843	0.000440987	0.000203989	0.000680261	0.000704787;
0.000487015	0.000335581	0.000188682	0.000546254	0.000253328	0.000696834	0.00054892;
0.000343785	0.000454819	0.000129718	0.000410346	0.000269072	0.000694366	0.00070388;
0.00056396	0.000454944	0.000178285	0.000437095	0.000254555	0.00070981	0.000616605;
0.00026684	0.000335456	0.000140115	0.000519505	0.000267845	0.00068139	0.000636195;
0.000393414	0.000416251	0.00014719	0.000405876	0.000316586	0.00069899	0.000585928;
0.000437386	0.000374149	0.00017121	0.000550724	0.000205814	0.00069221	0.000666872;
0.000420362	0.000383084	0.000183421	0.000542393	0.000258665	0.000707789	0.000595631;
0.000410438	0.000407316	0.000134979	0.000414207	0.000263735	0.000683411	0.000657169;
0.000524663	0.000392532	0.00019259	0.000526035	0.000228961	0.000694823	0.000664379;
0.000306137	0.000397868	0.00012581	0.000430565	0.000293439	0.000696377	0.000588421]

x2 =[
4.80063	6.13432;
4.56557	6.32768;
4.25865	7.19903;
5.10755	5.26297;
4.25277	7.04548;
5.11343	5.41652;
4.86843	5.34282;
4.49777	7.11918;
4.85917	5.34131;
4.50703	7.12069;
4.1279	6.69091;
5.2383	5.77109;
5.12782	5.84636;
4.23838	6.61564;
5.05625	6.69272;
4.30995	5.76928;
5.16514	6.72626;
4.20106	5.73574;
4.34524	7.15556;
5.02096	5.30644;
5.08299	6.86928;
4.28321	5.59272;
4.09988	6.16913;
5.26632	6.29287;
4.62927	6.2721;
4.73693	6.1899;
4.27244	6.9033;
5.09376	5.5587;
4.81462	6.02894;
4.55158	6.43306;
4.2346	6.9849;
5.1316	5.4771;
5.14717	5.64258;
4.21903	6.81942;
4.82042	6.13149;
4.54578	6.33051;
5.0611	6.2273;
4.3051	6.2347;
4.12492	5.58748
5.24128	6.87452;
4.45238	5.48433;
4.91382	6.97767;
4.43557	5.46735;
4.93063	6.99465;
4.09519	6.83255;
5.27101	5.62945;
4.04798	7.09787;
5.31822	5.36413;
4.75867	6.86826;
4.60753	5.59374;
4.36491	6.73102;
5.00129	5.73098;
4.49459	7.21704;
4.87161	5.24496;
4.72874	5.47819;
4.63746	6.98381;
4.6367	7.0577;
4.7295	5.4043;
4.96778	6.0526;
4.39842	6.4094;
4.44841	6.59535;
4.91779	5.86665;
5.03566	5.3837;
4.33054	7.0783;
4.07508	5.38967;
5.29112	7.07233;
4.79547	6.96792;
4.57073	5.49408;
4.85341	6.08223;
4.51279	6.37977;
5.04798	6.76986;
4.31822	5.69214;
4.4959	5.45615;
4.8703	7.00585;
5.04194	6.13552;
4.32426	6.32648;
4.85281	7.05084;
4.51339	5.41116;
4.07703	5.53232;
5.28917	6.92968;
5.026	5.69286;
4.3402	6.76914;
5.0421	6.92588;
4.3241	5.53612;
4.04913	5.79138;
5.31707	6.67062;
4.05903	6.23254;
5.30717	6.22946;
4.13986	6.00021;
5.22634	6.46179;
4.44388	5.63192;
4.92232	6.83008;
4.87968	6.17491;
4.48652	6.28709;
5.29759	5.47192;
4.06861	6.99008;
4.07016	6.71825;
5.29604	5.74375;
4.2408	5.55141;
5.1254	6.91059
]
DM = 4.4
x = [x1, x2]
Rs = zeros(100,1);
for(i=1:100)
lambdas = sum(x(i,1:5))+ x(i,6)*x(i,7)*(x(i,8)+x(i,9));
Rs(i,1) =exp(-lambdas*10);
end
Cs = zeros(100,1);
for(i=1:100)

Cs(i,1) = (24*(log10(1/1-exp(-x(i,1)*10)))+120) + (8*(log10(1/1-exp(-x(i,2)*10)))+80) + (8.75*(log10(1/1-exp(-x(i,3)*10)))+70) + (7.14*(log10(1/1-exp(-x(i,4)*10)))+50)+ (3.33*(log10(1/1-exp(-x(i,5)*10)))+30) + (18*(log10(1/1-exp(-x(i,6)*10)))+50) + (18*(log10(1/1-exp(-x(i,7)*10)))+50);
end

disp(Rs);
disp(Cs);

fitness_val = Rs - Cs;

disp(fitness_val);

 [value index] = max(fitness_val);
 
 gbest_fitness=value;
 gbest=x(index,:);


% velocities of particles
v=rand(100,9);


 
 % personal best of each particle
 pbest_fitness = fitness_val;
 pbest = x;
 
 
 % iteration to edit particle position and velocity
 % v= v + c1 * ud(pbest - x) + c2 * Ud(gbest - x)
 % x = x + v
 
 
 newv = v;
 newx = x;
 
 
 for(it=1:300)
 
 for(i=1:100)
   for(j=1:9)
       
     newv(i,j) = newv(i,j) + 1.49 * rand() * (pbest(i,j) - x(i,j)) + 1.49 * rand() * (gbest(1,j) - x(i,j));
     
     newx(i,j)= newx(i,j) + newv(i,j);
     
     if(newx(i,j) > 0.00048000 && j ==1 )
         newx(i,j) = 0.00048000;
     elseif(newx(i,j) < 0.00035000 && j ==1)
         newx(i,j) = 0.00035000;
		end 
		      if(newx(i,j) > 0.00046000 && j ==2 )
         newx(i,j) = 0.00046000;
     elseif(newx(i,j) < 0.00034000 && j ==2)
         newx(i,j) = 0.00034000;
end		 
		      if(newx(i,j) > 0.00018000 && j ==3 )
         newx(i,j) = 0.00018000;
     elseif(newx(i,j) < 0.00012000 && j ==3)
         newx(i,j) = 0.00012000;
	end	 
		      if(newx(i,j) > 0.00049000 && j ==4 )
         newx(i,j) = 0.00048000;
     elseif(newx(i,j) < 0.00039000 && j ==4)
         newx(i,j) = 0.00039000;
		end 
		      if(newx(i,j) > 0.00027000 && j ==5 )
         newx(i,j) = 0.00027000;
     elseif(newx(i,j) < 0.00021000 && j ==5)
         newx(i,j) = 0.00021000;
		 end
		      if(newx(i,j) > 0.00080000 && j ==6 )
         newx(i,j) = 0.00080000;
     elseif(newx(i,j) < 0.00072000 && j ==6)
         newx(i,j) = 0.00072000;
end		 
		      if(newx(i,j) > 0.00071000 && j ==7 )
         newx(i,j) = 0.00071000;
     elseif(newx(i,j) < 0.00054000 && j ==7)
         newx(i,j) = 0.00054000;
	end	 
		 
		      if(newx(i,j) > 5.44059032 && j ==8 )
         newx(i,j) = 5.44059032;
     elseif(newx(i,j) < 3.89216974 && j ==8)
         newx(i,j) = 3.89216974;
		end 
		 
		      if(newx(i,j) > 6.58829057 && j ==9 )
         newx(i,j) = 6.58829057;
     elseif(newx(i,j) < 5.24442022 && j ==9)
         newx(i,j) = 5.24442022;
		 end
     end
     
   end
 
 newx
 newv
 
 NewRs = zeros(100,1);
for(i=1:100)
lambdas = sum(x(i,1:5))+ x(i,6)*x(i,7)*(x(i,8)+x(i,9));
NewRs(i,1) =exp(-lambdas*10);
end
NewCs = zeros(100,1);
for(i=1:100)

NewCs(i,1) = (24*(log10(1/1-exp(-x(i,1)*10)))+120) + (8*(log10(1/1-exp(-x(i,2)*10)))+80) + (8.75*(log10(1/1-exp(-x(i,3)*10)))+70) + (7.14*(log10(1/1-exp(-x(i,4)*10)))+50)+ (3.33*(log10(1/1-exp(-x(i,5)*10)))+30) + (18*(log10(1/1-exp(-x(i,6)*10)))+50) + (18*(log10(1/1-exp(-x(i,7)*10)))+50);
end
NewRs
NewCs

disp(NewRs);
disp(NewCs);

new_fitness_val = NewRs - NewCs;

 [value index] = max(new_fitness_val);
h = [0 : 2: 200];
y = exp(-h)
%plot(h, y), axis([0 10 -1 1])
 if(gbest_fitness< value)
    gbest_fitness=value;
    gbest=newx(index,:);
 end
  for(i=1:100)
    if(pbest_fitness(i,1) < new_fitness_val(i,1))
        pbest_fitness(i,1) = new_fitness_val(i,1);
        pbest(i,:) = newx(i,:);
    end
  end
  
  
 end
 pbest
 gbest
 lambdas = sum(gbest(1:5))+ gbest(6)*gbest(7)*(gbest(8)+gbest(9));
 Rs =exp(-lambdas*10);
 Cs = ((24*(log10(1/1-exp(-gbest(1)*10)))+120) + (8*(log10(1/1-exp(-gbest(2)*10)))+80) + (8.75*(log10(1/1-exp(-gbest(3)*10)))+70) + (7.14*(log10(1/1-exp(-gbest(4)*10)))+50)+ (3.33*(log10(1/1-exp(-gbest(5)*10)))+30) + (18*(log10(1/1-exp(-gbest(6)*10)))+50) + (18*(log10(1/1-exp(-gbest(7)*10)))+50)) * DM;
 Cs
 Rs
 
 
 